<script>
  console.log("üîç DEBUG: Page Handle: {{ page.handle }}");
  console.log("üîç DEBUG: Template: {{ template }}");
  console.log("üîç DEBUG: Request Path: {{ request.path }}");
</script>

{% if page.handle == 'gameboard-leaderboard-1' or page.handle contains 'leaderboard' or request.path contains 'leaderboard' %}
  <div id="root-game" style="min-height: 800px; width: 100%; border: 2px solid #eaeaea;">
    <div style="padding: 100px; text-align: center;">
      <h2>üê∫ Loading Wolfpack Dashboard...</h2>
      <p>Status: Forcing Leaderboard View...</p>
    </div>
  </div>

  <script crossorigin src="https://unpkg.com/react@17/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@17/umd/react-dom.production.min.js"></script>

  <link rel="stylesheet" href="{{ 'main.css' | asset_url }}">
  <link rel="stylesheet" href="{{ 'game-app-styles.css' | asset_url }}">

  <script>
    (function() {
      console.clear();
      console.log("%c üê∫ DASHBOARD FORCE: ACTIVATED ", "background: blue; color: white; font-size: 20px;");

      // 1. Base URL
      var bundleUrl = "{{ 'game-app-bundle.js' | asset_url }}";
      var baseUrl = bundleUrl.split('game-app-bundle.js')[0];
      if (baseUrl.indexOf('//') === 0) baseUrl = 'https:' + baseUrl;
      
      // 2. Current Path
      var currentPath = window.location.pathname;

      // 3. Set Globals
      window.shopifyCdnPath = baseUrl;
      window.__webpack_public_path__ = baseUrl;
      
      // 4. FORCE CONFIGURATION
      window.pwaThemeVariables = {
        assetsUrl: baseUrl,
        publicPath: baseUrl,
        vendorPath: baseUrl + "vendor.js",
        cssPath: baseUrl + "main.css",
        logoPath: baseUrl + "wolfpack-logo.png",
        
        // A. FORCE LOGIN (Fake User)
        isAuthenticated: true,
        user: {
          id: 99999,
          email: "alpha@buildyourwolfpack.com",
          firstName: "Alpha",
          lastName: "Wolf",
          name: "Alpha Wolf"
        },

        // B. FORCE ROUTING (The Critical Fix)
        // We explicitly tell the app that THIS path is the dashboard
        gamePageHandle: 'gameboard-leaderboard-1',
        gamePagePath: currentPath,
        routes: {
          home: currentPath,
          game: currentPath,
          dashboard: currentPath, 
          leaderboard: currentPath
        }
      };

      console.log("‚úÖ DASHBOARD FORCE: Route locked to " + currentPath);
    })();
  </script>

  <script src="{{ 'game-app-bundle.js' | asset_url }}" type="module"></script>
{% else %}
  <div class="page-width page-width--narrow page-content">
    {%- render 'breadcrumbs' -%}
    <header class="section-header">
      <h1 class="section-header__title">{{ page.title }}</h1>
    </header>

    <div class="rte rte--nomargin">
      {{ page.content }}
    </div>
  </div>
{% endif %}

{% schema %}
{
  "name": "t:sections.main-page.name",
  "tag": "section"
}
{% endschema %}
